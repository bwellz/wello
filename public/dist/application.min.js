"use strict";var ApplicationConfiguration=function(){var applicationModuleName="wellofridge",applicationModuleVendorDependencies=["ngResource","ngAnimate","ui.sortable","ui.router","ui.bootstrap","angular-sortable-view"],registerModule=function(moduleName){angular.module(moduleName,[]),angular.module(applicationModuleName).requires.push(moduleName)};return{applicationModuleName:applicationModuleName,applicationModuleVendorDependencies:applicationModuleVendorDependencies,registerModule:registerModule}}();angular.module(ApplicationConfiguration.applicationModuleName,ApplicationConfiguration.applicationModuleVendorDependencies),angular.module(ApplicationConfiguration.applicationModuleName).config(["$locationProvider",function($locationProvider){$locationProvider.hashPrefix("!")}]),angular.element(document).ready(function(){var initInjector=angular.injector(["ng"]),$http=initInjector.get("$http");$http.get("/users/me?whyiewhy="+(new Date).getTime()).then(function(response){window.user="null"===response.data?null:response.data,angular.bootstrap(document,[ApplicationConfiguration.applicationModuleName])})}),ApplicationConfiguration.registerModule("core"),ApplicationConfiguration.registerModule("users"),angular.module("core").run(["$rootScope","$state","$location","Authentication",function($rootScope,$state,$location,Authentication){$rootScope.$on("$stateChangeStart",function(event,toState){"undefined"!=typeof toState.needloginstate?Authentication.user||(event.preventDefault(),$state.go(toState.needloginstate)):"undefined"!=typeof toState.hasloginstate&&Authentication.user&&(event.preventDefault(),$state.go(toState.hasloginstate))})}]),angular.module("core").config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/"),$stateProvider.state("index",{url:"/",templateUrl:"modules/core/views/index.client.view.html"}).state("fridge_base",{url:"/fridge/base",needloginstate:"fridge_base_auth",views:{"":{templateUrl:"modules/core/views/fridges/base/index.client.view.html"},"top@fridge_base":{templateUrl:"modules/core/views/fridges/base/top.client.view.html"},"bot@fridge_base":{templateUrl:"modules/core/views/fridges/base/bot.client.view.html"}}}).state("fridge_base_auth",{url:"/fridge/base/auth",hasloginstate:"fridge_base",views:{"":{templateUrl:"modules/core/views/fridges/base/index.client.view.html"},"top@fridge_base_auth":{templateUrl:"modules/core/views/fridges/base/auth.client.view.html"},"bot@fridge_base_auth":{templateUrl:"modules/core/views/fridges/base/bot_off.client.view.html"}}}).state("fridge_dx",{url:"/fridge/dx",templateUrl:"modules/core/views/fridges/dx.client.view.html"}).state("fridge_mini",{url:"/fridge/mini",templateUrl:"modules/core/views/fridges/mini.client.view.html"}).state("fridge_silver",{url:"/fridge/silver",templateUrl:"modules/core/views/fridges/silver.client.view.html"})}]),angular.module("core").directive("boardKeys",function(){return{restrict:"A",link:function(scope){$("html").on("mousedown",function(){scope.something_to_cancel&&(scope.hide_all(),scope.$apply())}),$("html").on("keydown",function(event){switch(event.keyCode){case 27:scope.hide_all(),scope.$apply()}})}}}),angular.module("core").controller("BoardController",["$scope","$state","$http","$timeout","Authentication","BoardService","FoodService","MessageService","AchievementService",function($scope,$state,$http,$timeout,Authentication,BoardService,FoodService,MessageService,AchievementService){$scope.authentication=Authentication,$scope.board=BoardService,$scope.boards=[];var board_index_lookup={};$scope.cur_board=null,$scope.edit_board=null,$scope.delete_board=null,$scope.edit_board_name="",$scope.new_board_name="",$scope.show_newboard=!1,$scope.something_to_cancel=!1,$scope.hide_all=function(){$scope.cancel_delete_board(),$scope.cancel_edit_board_name(),$scope.cancel_new_board()},$scope.initBoards=function(){$scope.boards=[],$scope.board.data=null,$scope.board.update++,$http.get("/boards?whyiewhy="+(new Date).getTime()).success(function(data){$scope.boards=data.boards,board_index_lookup={};for(var i=0;i<$scope.boards.length;i++)board_index_lookup[$scope.boards[i].board]=i;$scope.snake_board=data.snake_board,$scope.resume_board=data.resume_board,$scope.portfolio_board=data.portfolio_board,$scope.food_board=data.food_board,$scope.recipe_board=data.recipe_board,$scope.chores_board=data.chores_board,$scope.art_board=data.art_board,$scope.welcome_board=data.welcome_board,FoodService.food=data.food,FoodService.recipes=data.recipes,FoodService.achievements=data.achievements,FoodService.update++,$scope.loadBoard(data.cur_board===$scope.snake_board?data.return_board:data.cur_board),$timeout(function(){$(".board_scrollbar").perfectScrollbar({suppressScrollX:!0})},0),MessageService.remove_disaster("",2)}).error(function(err){MessageService.add_disaster(err.message,2)}),$timeout(function(){window.chrome&&AchievementService.achievement(49,1)},2e3)},$scope.$watch(function(){return BoardService.board_request},function(newVal){"undefined"!=typeof newVal&&null!==newVal&&("destroy"===newVal?$scope.signout():("snake"===newVal?newVal=$scope.snake_board:"cardbreaker"===newVal&&(newVal="cardbreaker"),$scope.loadBoard(newVal),$scope.board.board_request=null))}),$scope.loadBoard=function(board_id){if(BoardService.show_nibbles&&!BoardService.force)MessageService.flash_disaster("Look after your Wello Snake!",3e3);else if(BoardService.show_cardbreaker&&!BoardService.force)MessageService.flash_disaster("Munchkin isn't going to paddle herself!",3e3);else{if(BoardService.force=!1,$scope.cur_board===board_id)return $scope.something_to_cancel=!0,$scope.edit_board=board_id,void($scope.edit_board_name=$scope.boards[board_index_lookup[board_id]].name);$scope.cancel_edit_board_name(),$scope.cancel_delete_board(),$scope.cancel_new_board(),$scope.cur_board=board_id,$http.get("/board/"+board_id+"?whyiewhy="+(new Date).getTime()).success(function(data){$scope.board.data=data,$scope.board.update++,data._id===$scope.resume_board?(BoardService.custom_board=1,BoardService.name="Brad Wells's Resume",MessageService.remove_disaster("Current Board: Brad Wells's Resume",1),AchievementService.achievement(18,1)):data._id===$scope.portfolio_board?(BoardService.custom_board=2,BoardService.name="Brad Wells's Portfolio",MessageService.remove_disaster("Current Board: Brad Wells's Portfolio",1),AchievementService.achievement(19,1)):data._id===$scope.food_board?(BoardService.custom_board=3,BoardService.name="Food!",MessageService.remove_disaster("Current Board: Food!",1),AchievementService.achievement(20,1)):data._id===$scope.recipe_board?(BoardService.custom_board=4,BoardService.name="Recipes",MessageService.remove_disaster("Current Board: Recipes",1),AchievementService.achievement(21,1)):data._id===$scope.art_board?(BoardService.custom_board=5,BoardService.name="Crappy Kid's Artwork",MessageService.remove_disaster("Current Board: Crappy Kid's Artwork",1),AchievementService.achievement(23,1)):data._id===$scope.welcome_board?(BoardService.custom_board=6,BoardService.name="Achievement Progress",MessageService.remove_disaster("Current Board: Achievement Progress",1)):data._id!==$scope.snake_board&&"cardbreaker"!==data._id?($scope.boards[board_index_lookup[board_id]].trello_board&&AchievementService.achievement(8,1),$scope.boards[board_index_lookup[board_id]].truncated&&$scope.boards[board_index_lookup[board_id]].trello_board&&$timeout(function(){AchievementService.achievement(27,1)},2500),BoardService.custom_board=0,BoardService.name=$scope.boards[board_index_lookup[board_id]].name,MessageService.remove_disaster("Current Board: "+BoardService.name,1)):BoardService.custom_board=data._id===$scope.snake_board?7:8,$scope.custom_board=BoardService.custom_board}).error(function(err){MessageService.add_disaster(err.message,1)})}},$scope.show_new_board=function(){$scope.edit_board=null,$scope.delete_board=null,$scope.show_newboard=!0,$scope.something_to_cancel=!0},$scope.create_new_board=function(){$http.post("/new_board",{name:$scope.new_board_name}).success(function(data){$scope.boards.push({name:data.name,board:data.board}),board_index_lookup[data.board]=$scope.boards.length-1,$scope.loadBoard(data.board),$timeout(function(){$(".board_scrollbar").perfectScrollbar("update"),MessageService.flash_success("Successfully Created Board",3e3),AchievementService.achievement(10,1)},0)}).error(function(err){MessageService.flash_disaster(err.message,4e3)})},$scope.cancel_new_board=function(){$scope.show_newboard=!1,$scope.new_board_name="",$scope.something_to_cancel=!1},$scope.update_board_name=function(){$http.post("/board_name",{name:$scope.edit_board_name,board_id:$scope.cur_board}).success(function(data){AchievementService.achievement(44,1),$scope.boards[board_index_lookup[$scope.cur_board]].name=data.board_name,$scope.cancel_edit_board_name(),MessageService.post("Current Board: "+data.board_name),$timeout(function(){MessageService.flash_success("Successfully Updated Board Name",3e3)},0)}).error(function(err){MessageService.handle_error(err)})},$scope.cancel_edit_board_name=function(){$scope.edit_board=null,$scope.edit_board_name="",$scope.something_to_cancel=!1},$scope.toggle_star=function(board){var star,board_index=board_index_lookup[board];star=$scope.boards[board_index].starred?!1:!0,$http.post("/board_star",{star:star,board_id:board}).success(function(data){var $elem=$("#board_"+board);$elem.addClass("quick-fade-out"),$timeout(function(){$scope.boards[board_index].starred=data.star,data.star&&AchievementService.achievement(50,1),$elem.removeClass("quick-fade-out"),$elem.addClass("quick-fade-in"),$timeout(function(){$elem.removeClass("quick-fade-in")},450)},450),MessageService.flash_success("Successfully Toggled Board Star",3e3)}).error(function(err){MessageService.handle_error(err)})},$scope.show_delete_board=function(){$scope.something_to_cancel=!0,$scope.show_newboard=!1,$scope.delete_board=$scope.cur_board},$scope.delete_this_board=function(){$http.get("/delete_board/"+$scope.delete_board+"?whyiewhy="+(new Date).getTime()).success(function(data){if(AchievementService.achievement(45,1),0===data.boards.length)$scope.boards=[];else{for(var removed=!1,i=0;i<data.boards.length;i++)if($scope.boards[i].board!==data.boards[i].board){for($scope.boards.splice(i,1),removed=!0,i=0;i<$scope.boards.length;i++)board_index_lookup[$scope.boards[i].board]=i;break}removed||$scope.boards.pop()}$scope.loadBoard(data.cur_board),$timeout(function(){$(".board_scrollbar").perfectScrollbar("update")},0),MessageService.flash_success("Successfully Deleted Board",2e3)}).error(function(err){MessageService.flash_disaster(err.message,2e3)})},$scope.cancel_delete_board=function(){$scope.delete_board=null,$scope.something_to_cancel=!1},$scope.signout=function(){$scope.board.data=null,$scope.board.update++,$scope.boards=[],$scope.board_index_lookup={},BoardService.data=[],FoodService.food=[],FoodService.recipes=[],FoodService.achievements=[],BoardService.board_request=null,MessageService.post("Successfully Signed Out of Wello."),$state.go("signout_base")}}]),angular.module("core").controller("FridgeController",["$scope","$timeout","$interval","Authentication","BoardService","FoodPrepService","MessageService","AchievementService","CapabilityService",function($scope,$timeout,$interval,Authentication,BoardService,FoodPrepService,MessageService,AchievementService,CapabilityService){function startFood(){anim_now=Date.now(),food_animation_running=!0,$scope.munchkin.x=4490,$scope.munchkin.rock=0,munchkin_speed=-1e3,$scope.eating_food=null,ate_food=0,food_achieve=new Array(25);for(var i=0;25>i;i++)food_achieve[i]=0;animateFood()}function animateFood(){renderFood(),food_animation=window.requestAnimationFrame(animateFood)}function renderFood(){$timeout(function(){anim_prev=anim_now,anim_now=Date.now(),anim_elapsed=anim_now-anim_prev,num_salad=0;for(var i=0;i<$scope.flying_food.length;i++)10===$scope.flying_food[i].id&&(num_salad++,$scope.flying_food[i].rot+=food_rot_speed*(anim_elapsed/1e3),$scope.flying_food[i].x>1200?($scope.flying_food[i].x+=food_speed*(anim_elapsed/1e3),$scope.flying_food[i].x>1310?$scope.flying_food[i].y+=8*food_speed*(anim_elapsed/1e3):$scope.flying_food[i].x>1260?$scope.flying_food[i].y+=5*food_speed*(anim_elapsed/1e3):(AchievementService.achievement(31,1),$scope.flying_food[i].y+=3*food_speed*(anim_elapsed/1e3)),$scope.flying_food[i].x>1400&&($scope.flying_food.splice(i,1),i--)):($scope.flying_food[i].x+=food_speed*(anim_elapsed/1e3),$scope.flying_food[i].y=330-200*Math.sin(($scope.flying_food[i].x-900)/300*Math.PI)));if($scope.munchkin.x<4e3)for(i=0;i<$scope.flying_food.length;i++)10!==$scope.flying_food[i].id&&($scope.flying_food[i].rot+=food_rot_speed*(anim_elapsed/1e3),$scope.flying_food[i].x>1200?$scope.caught_food.length>=5||$scope.flying_food[i].dropping||$scope.munchkin_passed_out?($scope.flying_food[i].dropping=!0,$scope.flying_food[i].x+=food_speed*(anim_elapsed/1e3),$scope.flying_food[i].x>1310?$scope.flying_food[i].y+=8*food_speed*(anim_elapsed/1e3):$scope.flying_food[i].x>1260?$scope.flying_food[i].y+=5*food_speed*(anim_elapsed/1e3):(AchievementService.achievement(29,1),$scope.flying_food[i].y+=3*food_speed*(anim_elapsed/1e3)),$scope.flying_food[i].x>1400&&($scope.flying_food.splice(i,1),i--)):(temp=$scope.flying_food.splice(i,1)[0],temp.x=0,temp.y=0,$scope.caught_food.push(temp),i--,food_achieve[temp.id]++,food_achieve[4]>0&&food_achieve[7]>0&&food_achieve[16]>0&&food_achieve[24]>0?AchievementService.achievement(11,1):food_achieve[8]>0&&food_achieve[14]>0&&food_achieve[15]>0&&food_achieve[18]>0&&AchievementService.achievement(3,1)):($scope.flying_food[i].x+=food_speed*(anim_elapsed/1e3),$scope.flying_food[i].y=330-200*Math.sin(($scope.flying_food[i].x-900)/300*Math.PI)));null!==$scope.eating_food||$scope.munchkin_passed_out||$scope.caught_food.length>0&&($scope.caught_food.length>=5||$scope.flying_food.length===num_salad)&&($scope.eating_food=$scope.caught_food.pop(),ate_food++),null!==$scope.eating_food?($scope.eating_food.x+=80*(anim_elapsed/1e3),$scope.eating_food.y-=60*(anim_elapsed/1e3),$scope.eating_food.opacity-=.66*(anim_elapsed/1e3),$scope.eating_food.scale-=.66*(anim_elapsed/1e3),$scope.eating_food.scale<.05&&((23===$scope.eating_food.id||24===$scope.eating_food.id||19===$scope.eating_food.id)&&(munchkin_bac+=1,munchkin_bac>4.1&&(MessageService.flash("Phew, Munchkin drank too much and passed out!",3e3),AchievementService.achievement(28,1),$scope.munchkin_passed_out=!0)),food_achieve[$scope.eating_food.id]--,$scope.eating_food=null),$scope.munchkin_passed_out||($scope.munchkin.rock+=munchkin_rock*(anim_elapsed/1e3),$scope.munchkin.rock>3?($scope.munchkin.rock=3,munchkin_rock=-22):$scope.munchkin.rock<-3&&($scope.munchkin.rock=-3,munchkin_rock=22))):$scope.munchkin_passed_out||($scope.caught_food.length>0||$scope.flying_food.length>num_salad?-101>munchkin_speed?($scope.munchkin.x+=munchkin_speed*(anim_elapsed/1e3),munchkin_speed=$scope.munchkin.x>2500?-6e3:$scope.munchkin.x>1800?-3e3:$scope.munchkin.x>1550?-500:$scope.munchkin.x>1250?-200:100):($scope.munchkin.x+=munchkin_speed*(anim_elapsed/1e3),$scope.munchkin.x>1400?munchkin_speed=-102:$scope.munchkin.x>1300?munchkin_speed=-100:$scope.munchkin.x<1250&&($scope.munchkin.x=1250,munchkin_speed=100)):$scope.munchkin.x+=$scope.munchkin.x>1600?2e3*(anim_elapsed/1e3):80*(anim_elapsed/1e3)),$scope.munchkin.x>4500&&0===num_salad&&(food_animation_running=!1,window.cancelAnimationFrame(food_animation))})}$scope.authentication=Authentication,$scope.freezer_show=!1,$scope.freezer_open=!1,$scope.door_opening=0,$scope.hide_door=!1,$scope.fridge_show=!1,$scope.fridge_open=!1,$scope.door2_opening=0,$scope.hide_door2=!1,$scope.munchkin={x:4490,rock:0},$scope.flying_food=[],$scope.caught_food=[],$scope.eating_food=null;var food_animation,anim_prev,anim_now,anim_elapsed,ate_food,temp,food_animation_running=!1,munchkin_speed=100,food_speed=150,food_rot_speed=360,zindex=99999,num_salad=0,munchkin_rock=22,munchkin_bac=0;$scope.munchkin_passed_out=!1;var food_achieve=[];$scope.show_resolution_warning=0,$scope.suppress_resolution=0,$scope.show_browser_warning=0,$scope.suppress_browser=0,$scope.height=0,$scope.width=0,$scope.show_mobile=!1,angular.extend($scope,CapabilityService),$scope.init_capability_check($scope),$scope.sup_browser=function(val){$scope.suppress_browser=val},$scope.sup_resolution=function(val){$scope.suppress_resolution=val},$scope.bgScroll=function(bg,color,speed){document.body.style.background=color+" url('"+bg+"') no-repeat",document.body.style.backgroundSize="100%",window.onscroll=function(){document.body.style.backgroundPosition=window.pageXOffset+"px "+-window.pageYOffset/speed+"px"}},$scope.$watch(function(){return FoodPrepService.new_food},function(newVal,oldVal){if(newVal!==oldVal&&null!==newVal){$scope.flying_food.push({x:900,y:330,scale:1,opacity:1,rot:-20,id:FoodPrepService.food_id,file:newVal,dropping:!1}),zindex--,FoodPrepService.new_food=null,food_animation_running||startFood()}}),$interval(function(){munchkin_bac-=1,$scope.munchkin_passed_out&&2>munchkin_bac&&($scope.munchkin_passed_out=!1,MessageService.flash("For better or worse, Munchkin is back...",3e3)),0>munchkin_bac&&(munchkin_bac=0),AchievementService.achievement(1,ate_food),ate_food=0},1e4),$scope.door1_animation=function(){$scope.freezer_open===!1&&($scope.door_opening=1,$scope.freezer_open=!0,$scope.freezer_show=!0,$timeout(function(){$scope.hide_door=!0},2e3),MessageService.flash("Opening Freezer",2e3),AchievementService.achievement(30,1))},$scope.door1_close_animation=function(){$scope.freezer_open===!0&&($scope.door_opening=2,$scope.hide_door=!1,$timeout(function(){$scope.freezer_show=!1,$timeout(function(){$scope.door_opening=0,$scope.freezer_open=!1},1e3)},2e3),MessageService.flash("Closing Freezer",2e3))},$scope.door2_animation=function(){$scope.fridge_open===!1&&($scope.door2_opening=1,$scope.fridge_open=!0,$scope.fridge_show=!0,$timeout(function(){$scope.hide_door2=!0},2e3),MessageService.flash("Opening Fridge",2e3),AchievementService.achievement(32,1))},$scope.door2_close_animation=function(){$scope.fridge_open===!0&&($scope.door2_opening=2,$scope.hide_door2=!1,$timeout(function(){$scope.fridge_show=!1,$timeout(function(){$scope.door2_opening=0,$scope.fridge_open=!1},1e3)},2e3),MessageService.flash("Closing Fridge",2e3))},$scope.signout=function(){BoardService.board_request="destroy"}}]),angular.module("core").controller("HomeController",["$scope","$state","$timeout","Authentication","CapabilityService",function($scope,$state,$timeout,Authentication,CapabilityService){$scope.authentication=Authentication,document.body.style.backgroundImage="none",document.body.style.backgroundColor="#23719F",$scope.fridges=[{name:"Wello Fridge Classic	",link:"#!/fridge/base",marketing:[{icon:"ok",text:"Classic Design"},{icon:"cloud-download",text:"Magically imports your Trello boards"},{icon:"flash",text:"Utilizes WelloBeam: the NOT-AT-ALL DANGEROUS card-projection technology"},{icon:"tree-deciduous",text:"Instantly 3D-print food with tofu!"},{icon:"cutlery",text:"Easily prepare any meal with automated cooking using ingredients in your fridge!"},{icon:"picture",text:"Always know the weather unless it's not pleasant with CatWeather"},{icon:"tag",text:"$12,899.95"}]},{name:"Wello Fridge DX",link:"#!/fridge/dx",marketing:[{icon:"asterisk",text:"For the most demanding Wello customer"},{icon:"ok",text:"All of the same incredible features of the Wello Fridge Classic plus new exclusives"},{icon:"globe",text:"Shame your friends into action with the ALS Challenge attachment"},{icon:"glass",text:"Includes the Wello Whiskey-Ice Maker, designed by Ferrari and available to you thanks to extensive industrial espionage"},{icon:"fire",text:"Unexplained fires are a relatively rare occurence and a matter for the courts"},{icon:"tag",text:"A lot of easy payments of $11,999.99"}]},{name:"Wello Fridge Mini",link:"#!/fridge/mini",marketing:[{icon:"asterisk",text:"The perfect dorm room fridge as long as your parents are filthy rich and spoil you"},{icon:"ok",text:"All the same features and thus the same cost as the Wello Fridge Classic, but amazingly a quarter the size"},{icon:"glass",text:"A false back showing an empty fridge allows you to easily guilt your parents into sending you beer money, which you already had since they spoil you"},{icon:"tag",text:"$12,899.95"}]},{name:"Wello Fridge Silver",link:"#!/fridge/silver",marketing:[{icon:"asterisk",text:'For our gullible consumer who yearns for the "better" days'},{icon:"ok",text:"Some features, maybe, if you angle it right"},{icon:"flash",text:"14.4k modem with speed boost, which honestly doesn't do anything"},{icon:"heart",text:"Holds more yams than any other fridge"},{icon:"tag",text:"The majority of your retirement savings"}]}],$scope.show_resolution_warning=0,$scope.suppress_resolution=0,$scope.show_browser_warning=0,$scope.suppress_browser=0,$scope.height=0,$scope.width=0,$scope.show_mobile=!1,angular.extend($scope,CapabilityService),$scope.init_capability_check($scope),$scope.sup_browser=function(val){$scope.suppress_browser=val},$scope.sup_resolution=function(val){$scope.suppress_resolution=val},$scope.goto=function(state){$state.go(state)}}]),angular.module("core").factory("MessageService",["$timeout",function($timeout){function flash_to(msg,to,defmes){msg_service.message=msg,msg_service.update++,msg_service.disaster_type=null,msg_service.to=to,msg_service.defmes="undefined"!=typeof defmes?defmes:null}var msg_service={message:"",to:-1,defmes:null,update:0,disaster:!1,success:!1,achievement:!1,disaster_type:null};return msg_service.handle_error=function(err){$timeout(function(){"undefined"==typeof err.message?msg_service.flash_disaster("Unable to connect to server.",3e3):msg_service.flash_disaster(err.message,3e3)})},msg_service.post=function(msg){msg_service.message=msg,msg_service.update++,msg_service.disaster=!1,msg_service.success=!1,msg_service.disaster_type=null,msg_service.to=-1,msg_service.achievement=!1},msg_service.flash=function(msg,to,defmes){msg_service.disaster=!1,msg_service.success=!1,msg_service.achievement=!1,flash_to(msg,to,defmes)},msg_service.flash_disaster=function(msg,to,defmes){msg_service.disaster=!0,msg_service.success=!1,msg_service.achievement=!1,flash_to(msg,to,defmes)},msg_service.flash_success=function(msg,to,defmes){msg_service.disaster=!1,msg_service.success=!0,msg_service.achievement=!1,flash_to(msg,to,defmes)},msg_service.flash_achievement=function(msg,to){msg_service.disaster=!1,msg_service.success=!1,msg_service.achievement=!0,flash_to(msg,to)},msg_service.add_disaster=function(msg,type){msg_service.message=msg,msg_service.update++,msg_service.disaster=!0,msg_service.success=!1,msg_service.achievement=!1,msg_service.disaster_type=type,msg_service.to=-1},msg_service.remove_disaster=function(msg,type){msg_service.message=msg,msg_service.update++,msg_service.disaster=!1,msg_service.success=!1,msg_service.achievement=!1,msg_service.disaster_type=type,msg_service.to=-1},msg_service.revert=function(){msg_service.message=null,msg_service.update++,msg_service.disaster=!1,msg_service.success=!1,msg_service.achievement=!1,msg_service.disaster_type=null,msg_service.to=-1},msg_service}]),angular.module("core").controller("MessageController",["$scope","$timeout","Authentication","BoardService","MessageService",function($scope,$timeout,Authentication,BoardService,MessageService){function anim(txt){if($scope.message!==txt){var div=$(".status_anim");div.stop(!0),div.animate({opacity:"0.0"},100),div.animate({opacity:"1.0"},400),$timeout(function(){$scope.message=txt,$scope.disaster=disaster,$scope.msg_success=msg_success,$scope.msg_achievement=msg_achievement},100)}}$scope.message="",$scope.disaster=!1,$scope.msg_success=!1,$scope.msg_achievement=!1;var def,timeout_disaster,timeout_success,found,disaster=!1,msg_success=!1,msg_achievement=!1,active_disasters=[],mto=null,mto_block=null,root_disaster=!1;$scope.$watch(function(){return MessageService.update},function(){var i;if(null===MessageService.message)(disaster===!1||MessageService.disaster||timeout_disaster)&&($timeout.cancel(mto),root_disaster||(disaster=!1),anim(def),mto=null);else if(MessageService.to>0){if(disaster&&!MessageService.disaster&&!MessageService.success)return;null!==MessageService.defmes&&(def=MessageService.defmes,MessageService.defmes=null),MessageService.disaster===!0?(disaster=!0,msg_achievement=!1,msg_success=!1):MessageService.achievement===!0?(disaster=!1,msg_success=!0,msg_achievement=!0):MessageService.success===!0?(disaster=!1,msg_success=!0,msg_achievement=!1):(disaster=!1,msg_success=!1,msg_achievement=!1),anim(MessageService.message),timeout_disaster=MessageService.disaster,timeout_success=MessageService.success,$timeout.cancel(mto),$timeout.cancel(mto_block),mto_block=$timeout(function(){mto_block=null},200),mto=$timeout(function(){MessageService.message=null,MessageService.update++,root_disaster||(disaster=!1),msg_success=!1,msg_achievement=!1,mto=null},MessageService.to),MessageService.to=-1,MessageService.disaster=!1,MessageService.success=!1,MessageService.achievement=!1}else{if(null!==MessageService.disaster_type)if(MessageService.disaster===!0){for(found=!1,i=0;i<active_disasters.length;i++)MessageService.disaster_type===active_disasters[i].dt&&(found=!0);found||active_disasters.push({msg:MessageService.message,dt:MessageService.disaster_type})}else for(i=0;i<active_disasters.length;i++)if(active_disasters[i].dt===MessageService.disaster_type){active_disasters.splice(i,1);break}if(active_disasters.length>0?(root_disaster=!0,MessageService.disaster===!1&&(MessageService.disaster=!0,MessageService.message=active_disasters[0].msg)):(root_disaster=!1,disaster&&(disaster=!1)),MessageService.disaster===!0)def=MessageService.message,disaster===!1&&(msg_success=!1,$timeout.cancel(mto),anim(def),disaster=!0);else{if(root_disaster===!0)return;def=MessageService.message,disaster===!1&&null===mto_block&&(msg_success=!1,msg_achievement=!1,$timeout.cancel(mto),mto=null,anim(def))}MessageService.disaster=!1,MessageService.success=!1,MessageService.achievement=!1,MessageService.disaster_type=null}})}]),angular.module("core").controller("WeatherController",["$scope","$http","$timeout","Authentication","MessageService","AchievementService",function($scope,$http,$timeout,Authentication,MessageService,AchievementService){function cat_messages(successful){$scope.icon="/modules/core/img/weather/"+$scope.icon,$scope.first_weather===!1&&(successful?("US"!==$scope.country?$timeout(function(){AchievementService.achievement(52,1)},3e3):"New York"===$scope.city&&$timeout(function(){AchievementService.achievement(36,1)},3e3),$scope.showcats===!0?($scope.temp>=100?(achievement(33,1),$timeout(function(){AchievementService.achievement(38,1)},6e3)):AchievementService.achievement(38,1),MessageService.flash("The weather is not too great there, here is a cat.",3e3)):(MessageService.flash("The weather is pretty nice there today, no need for cats.",3e3),$scope.temp>=72&&$scope.temp<73&&"Clear"===$scope.condition?(achievement(34,1),$timeout(function(){AchievementService.achievement(37,1)},6e3)):AchievementService.achievement(37,1))):"Mars"===$scope.state?(MessageService.flash("Little dusty to say the least.",3e3),AchievementService.achievement(35,1)):MessageService.flash_disaster("Unable to load weather.",3e3)),$scope.first_weather=!1}$scope.authentication=Authentication,$scope.first_weather=!0,$scope.updateZip=function(){$http.post("/change_zip",{zip:$scope.new_zip}).success(function(){Authentication.user.zip=$scope.new_zip,$scope.loadWeather(),$scope.editzip=!1})},$scope.loadWeather=function(){$scope.loadingweather=!0,$scope.showcats=!1,$scope.zip=Authentication.user.zip,$http.post("/weather",{zip:$scope.zip}).success(function(data){$scope.state=data.state,$scope.country=data.country,$scope.city=data.city,$scope.temp=data.temp,$scope.condition=data.condition,$scope.icon=data.icon;var weather_id=data.weather_id,weather_des=data.weather_des;"Mars"===$scope.state?($scope.showcats=!0,$scope.catmessage="Wello has no idea where you were trying to lookup, but they probably don't have that many cat pictures there.",$scope.loadingweather=!1,$scope.city="Soujourner's Grave",$scope.state="Mars",$scope.cat="/modules/core/img/cats/"+Math.floor(11.999*Math.random())+".jpg",cat_messages(!1)):("04n"===$scope.icon||"04d"===$scope.icon||721===weather_id?($scope.icon="partly_cloudy.png",$scope.condition_text="Partly Cloudy"):"01n"===$scope.icon||"01d"===$scope.icon?($scope.icon="sunny.png",$scope.condition_text="Sunny"):"02n"===$scope.icon||"02d"===$scope.icon?($scope.icon="mostly_sunny.png",$scope.condition_text="Mostly Sunny"):"03n"===$scope.icon||"03d"===$scope.icon?($scope.icon="partly_cloudy.png",$scope.condition_text="Partly Cloudy"):"09n"===$scope.icon||"09d"===$scope.icon?($scope.icon="rainy.png",$scope.condition_text="Rainy"):"10n"===$scope.icon||"10d"===$scope.icon?($scope.icon="rainy.png",$scope.condition_text="Rainy"):"11n"===$scope.icon||"11d"===$scope.icon?($scope.icon="thunder_storm.png",$scope.condition_text="Thunder Storms"):"13n"===$scope.icon||"13d"===$scope.icon?($scope.icon="snowy.png",$scope.condition_text="Snowy"):("50n"===$scope.icon||"50d"===$scope.icon)&&($scope.icon="cloudy.png",$scope.condition_text="Cloudy"),$scope.temp<50?($scope.showcats=!0,$scope.catmessage="It's freezing outside in "+$scope.city+" at "+$scope.temp+" degrees.  No problem though, because cat pictures are inside."):$scope.temp<60?($scope.showcats=!0,$scope.catmessage="It's a little chilly in "+$scope.city+" at "+$scope.temp+" degrees, better look at some pictures of cats instead of worrying about the specifics."):$scope.temp>90?($scope.showcats=!0,$scope.catmessage="It's way too hot in "+$scope.city+" at "+$scope.temp+" degrees.  Instead of ruining your day by showing you exactly how hot, here are some cat pictures."):"Clear"===$scope.condition||"Clouds"===$scope.condition||weather_id>=905&&955>=weather_id||721===weather_id?$scope.showcats=!1:($scope.showcats=!0,$scope.catmessage="Meh, the temperature outside is fine, but there is some nasty "+weather_des+" action going on out in "+$scope.city+".  Better stay in and look at cats."),$scope.loadingweather=!1,$scope.showcats===!0&&($scope.cat="/modules/core/img/cats/"+Math.floor(11.999*Math.random())+".jpg"),cat_messages(!0))}).error(function(){$scope.showcats=!0,$scope.catmessage="Wello has lost 100% of their fridge sales to piracy and the weather API was the first resultant budget cut, but not all is lost -- here are some cat pictures.",$scope.loadingweather=!1,$scope.city="?????",$scope.state="??",$scope.cat="/modules/core/img/cats/"+Math.floor(11.999*Math.random())+".jpg",cat_messages(!1)})}}]),angular.module("core").controller("ModalController",["$scope","$modalInstance","data",function($scope,$modalInstance,data){$scope.custom_board=data.custom_board,$scope.label_names=data.label_names,$scope.card=data.card,$scope.labels_locked=data.labels_locked,$scope.card_locked=data.card_locked,$scope.label_func=data.toggle_card_label,$scope.name_func=data.commit_card_name,$scope.des_func=data.commit_card_des,$scope.delete_func=data.commit_card_delete,$scope.edit_name="",$scope.show_edit_name=!1,$scope.edit_des="",$scope.show_edit_des=!1,$scope.show_delete=!1;var food_func=data.food_func,recipe_func=data.recipe_func,achievement_func=data.achievement_func;$scope.card.munchkined&&achievement_func(0,1),6===$scope.custom_board?$scope.achievement=data.achievements[$scope.card.achievement_ref]:4===$scope.custom_board?($scope.food=data.food,$scope.recipe=data.recipes[$scope.card.recipe_ref],achievement_func(22,1)):3===$scope.custom_board&&($scope.food=data.food),$scope.show_edit_name=function(){$scope.card_locked||($scope.show_name=!0,$scope.edit_name=$scope.card.name,$scope.show_delete=!1)},$scope.commit_name=function(){$scope.card_locked||$scope.name_func($scope.edit_name,function(result){$scope.card.name=result,$scope.edit_name="",$scope.show_name=!1
})},$scope.hide_edit_name=function(){$scope.show_name=!1,$scope.edit_name=""},$scope.show_edit_des=function(){$scope.card_locked||($scope.show_des=!0,$scope.edit_des=$scope.card.des,$scope.show_delete=!1)},$scope.commit_des=function(){$scope.card_locked||$scope.des_func($scope.edit_des,function(result){$scope.card.des=result,$scope.edit_des="",$scope.show_des=!1})},$scope.hide_edit_des=function(){$scope.show_des=!1,$scope.edit_des=""},$scope.toggle_label=function(index){$scope.labels_locked||($scope.show_delete=!1,$scope.label_func(index,function(result){$scope.card.labels[index]=result}))},$scope.show_delete_dialog=function(){$scope.card_locked||($scope.show_delete=!0,$scope.show_name=!1,$scope.show_des=!1)},$scope.commit_delete=function(){$scope.card_locked||$scope.delete_func(function(){$modalInstance.dismiss("cancel")})},$scope.hide_delete_dialog=function(){$scope.show_delete=!1},$scope.create_food=function(food){food_func(food)},$scope.prepare_recipe=function(recipe){recipe_func(recipe)},$scope.num_labels=function(){for(var c=0,i=0;6>i;i++)$scope.card.labels[i]&&c++;return c},$scope.cancel=function(){$modalInstance.dismiss("cancel")}}]),angular.module("core").controller("FridgeWelloController",["$scope","$http","$timeout","$interval","$modal","Authentication","BoardService","FoodService","FoodPrepService","MessageService","AchievementService",function($scope,$http,$timeout,$interval,$modal,Authentication,BoardService,FoodService,FoodPrepService,MessageService,AchievementService){function resize_list(list,scrollto){var $elem=$(".list").eq(list),thish=360-$elem.children(".list_head").height()-$elem.children(".list_foot").height()+"px";$elem=$elem.children(".scrollbar-dynamic"),$elem.css("max-height",thish),scrollto>-1&&$elem.scrollTop(scrollto),$elem.perfectScrollbar("update")}function ingredients(food){for(var num_food=food.length,has_any_of_food=0,helpings=[],i=0;i<food.length;i++)$scope.food[food[i].food].count>0&&(has_any_of_food++,helpings.push(Math.floor($scope.food[food[i].food].count/food[i].count)));if(0===has_any_of_food)return-1;if(num_food>has_any_of_food)return 0;for(has_any_of_food=1e6,i=0;i<helpings.length;i++)helpings[i]<has_any_of_food&&(has_any_of_food=helpings[i]);return has_any_of_food}function notOKCandySpawn(){if($scope.candy_x>=$scope.cat_x&&$scope.candy_x<$scope.cat_x+$scope.cat_size&&$scope.candy_y>=$scope.cat_y&&$scope.candy_y<$scope.cat_y+$scope.cat_size||$scope.candy_x>=$scope.list_x&&$scope.candy_x<$scope.list_x+$scope.list_size_x&&$scope.candy_y>=$scope.list_y&&$scope.candy_y<$scope.list_y+$scope.list_size_y)return!0;for(var i=0;i<$scope.wello_snake.length;i++)if($scope.candy_x===$scope.wello_snake[i].x&&$scope.candy_y===$scope.wello_snake[i].y)return!0;return!1}function init_cb_pos(){for(var i=0;i<$scope.cb_level.length;i++)for(var j=0;j<$scope.cb_level[i].length;j++)$scope.cb_level[i][j].top=42*j}function animate_cardbreaker(){render_cardbreaker(),cardbreaker_animation=window.requestAnimationFrame(animate_cardbreaker)}function render_cardbreaker(){$timeout(function(){card_anim_prev=card_anim_now,card_anim_now=Date.now(),card_anim_elapsed=card_anim_now-card_anim_prev;for(var i=0;i<$scope.dropping_food.length;i++)$scope.dropping_food[i].top+=.2*card_anim_elapsed,$scope.dropping_food[i].top>410?$scope.dropping_food.splice(i,1):$scope.dropping_food[i].top>340&&$scope.paddle_x<$scope.dropping_food[i].left+40&&$scope.paddle_x+$scope.paddle_size>$scope.dropping_food[i].left+40&&(1===$scope.dropping_food[i].type?($scope.cb_lives--,$scope.paddle_size=100,$scope.ball_x=200,$scope.ball_y=350,cb_laser=!1,ball_speed_x=-250*cumulative_speed,ball_speed_y=-250*cumulative_speed):2===$scope.dropping_food[i].type?cardbreaker_score+=10:3===$scope.dropping_food[i].type?(cardbreaker_score+=20,$scope.paddle_size=150):4===$scope.dropping_food[i].type?(cardbreaker_score+=35,cb_laser=!0,last_laser=Date.now()):6===$scope.dropping_food[i].type?cardbreaker_score+=5:(cardbreaker_score+=50,$scope.cb_lives++),cardbreaker_score>$scope.cardbreaker_top_score&&($scope.cardbreaker_top_score=cardbreaker_score),$scope.dropping_food.splice(i,1),MessageService.post("Wello Card Breaker - Lives: "+$scope.cb_lives+" Score: "+cardbreaker_score+" (Top Score: "+$scope.cardbreaker_top_score+")"));for(cb_laser&&Date.now()>last_laser+2e3&&(last_laser=Date.now(),$scope.lasers.push({left:$scope.paddle_x+$scope.paddle_size/2,top:350})),i=0;i<$scope.lasers.length;i++)$scope.lasers[i].top-=.15*card_anim_elapsed,$scope.lasers[i].top<-40&&$scope.lasers.splice(i,1);for(ball_x_last=$scope.ball_x,ball_y_last=$scope.ball_y,$scope.ball_x+=ball_speed_x*(card_anim_elapsed/1e3),$scope.ball_y+=ball_speed_y*(card_anim_elapsed/1e3),card_collision=!1,i=0;i<$scope.cb_level.length;i++){x_begin=180*i,x_end=180*(i+1);for(var j=0;j<$scope.cb_level[i].length;j++){y_begin=40*j,y_end=40*(j+1);for(var k=0;k<$scope.lasers.length;k++)$scope.lasers[k].left>x_begin&&$scope.lasers[k].left<x_end&&$scope.lasers[k].top<y_end&&($scope.lasers.splice(k,1),$scope.cb_level[i][j].labels--,$scope.cb_level[i][j].labels>0&&$scope.dropping_food.push(Math.random()<.3?{top:y_end,left:x_begin+70,type:1,image:"modules/core/img/recipes/salad.png"}:{top:y_end,left:x_begin+70,type:6,image:"modules/core/img/recipes/cheeseburger.png"}),ball_speed_x*=1.01,ball_speed_y*=1.01,cumulative_speed*=1.01);!card_collision&&$scope.ball_x+munchkin_size>x_begin&&$scope.ball_x-munchkin_size<x_end&&$scope.ball_y+munchkin_size>y_begin&&$scope.ball_y-munchkin_size<y_end&&$scope.cb_level[i][j].labels>0&&(card_collision=!0,$scope.cb_level[i][j].labels--,$scope.cb_level[i][j].labels>0&&$scope.dropping_food.push(Math.random()<.3?{top:y_end,left:x_begin+70,type:1,image:"modules/core/img/recipes/salad.png"}:{top:y_end,left:x_begin+70,type:6,image:"modules/core/img/recipes/cheeseburger.png"}),ball_speed_x*=1.01,ball_speed_y*=1.01,cumulative_speed*=1.01,ball_x_last-munchkin_size>x_end&&$scope.ball_x-munchkin_size<x_end?($scope.ball_x=ball_x_last,ball_speed_x*=-1):x_begin>ball_x_last+munchkin_size&&$scope.ball_x+munchkin_size>x_begin?($scope.ball_x=ball_x_last,ball_speed_x*=-1):($scope.ball_y=ball_y_last,ball_speed_y*=-1)),0===$scope.cb_level[i][j].labels&&(cb_count--,food_type=Math.random(),.3>food_type?(food_type=1,food_image="modules/core/img/recipes/salad.png"):.8>food_type?(food_type=2,food_image="modules/core/img/recipes/hotdog.png"):.88>food_type?(food_type=3,food_image="modules/core/img/recipes/surfandturf.png"):.96>food_type?(food_type=4,food_image="modules/core/img/recipes/redbullvodka.png"):(food_type=5,food_image="modules/core/img/recipes/whiskey.png"),$scope.dropping_food.push({top:y_end,left:x_begin+70,type:food_type,image:food_image}),$scope.cb_level[i].splice(j,1))}}0===$scope.cb_lives&&($scope.show_cardbreaker=!1,$scope.cardbreaker_cloak=!0,BoardService.show_cardbreaker=!1,BoardService.board_request=card_return_board,window.cancelAnimationFrame(cardbreaker_animation)),card_collision||($scope.ball_x<munchkin_size?(ball_speed_x*=-1,$scope.ball_x=munchkin_size+.01):$scope.ball_x>900-munchkin_size?(ball_speed_x*=-1,$scope.ball_x=899.99-munchkin_size):$scope.ball_y<munchkin_size?(ball_speed_y*=-1,$scope.ball_y=munchkin_size+.01):$scope.ball_y>380-munchkin_size&&$scope.ball_x+munchkin_size>$scope.paddle_x&&$scope.ball_x-munchkin_size<$scope.paddle_x+$scope.paddle_size?(ball_speed_y*=-1,$scope.ball_y=379-munchkin_size,ball_flatness=($scope.ball_x-$scope.paddle_size/2-$scope.paddle_x)*Math.PI/(1.6*$scope.paddle_size),ball_speed=Math.sqrt(ball_speed_x*ball_speed_x+ball_speed_y*ball_speed_y),ball_speed_y=-ball_speed*Math.cos(ball_flatness),ball_speed_x=ball_speed*Math.sin(ball_flatness)):$scope.ball_y>400-munchkin_size&&($scope.cb_lives--,$scope.ball_x=200,$scope.ball_y=350,ball_speed_x=-250*cumulative_speed,ball_speed_y=-250*cumulative_speed,cb_laser=!1,$scope.paddle_size=100,MessageService.post("Wello Card Breaker - Lives: "+$scope.cb_lives+" Score: "+cardbreaker_score+" (Top Score: "+$scope.cardbreaker_top_score+")"))),0===cb_count&&($scope.cb_level=[[{labels:6},{labels:3},{labels:1},{labels:1},{labels:1}],[{labels:4},{labels:4},{labels:1},{labels:1},{labels:1}],[{labels:6},{labels:5},{labels:1},{labels:1},{labels:6}],[{labels:4},{labels:4},{labels:1},{labels:1},{labels:1}],[{labels:6},{labels:3},{labels:1},{labels:1},{labels:1}]],init_cb_pos(),cb_count=25,$scope.ball_x=200,$scope.ball_y=350,ball_speed_x=-250*cumulative_speed,ball_speed_y=-250*cumulative_speed)})}function cleanup_party(){for(var i=0;i<$scope.board_data.lists.length;i++)for(var j=0;j<$scope.board_data.lists[i].cards.length;j++)void 0===$scope.board_data.lists[i].cards[j]&&$scope.board_data.lists[i].cards.splice(j,1);$timeout(function(){$(".list").each(function(){$(this).children(".scrollbar-dynamic").scrollTop(0).perfectScrollbar({suppressScrollX:!0})})},1e3),party_ended=!0}Authentication.signincb="base",$scope.edit_label=!1,$scope.something_to_cancel=!1,$scope.food_categories=[],$scope.food_category=null,$scope.food_select=null,$scope.food=[],$scope.ice_id=-1,$scope.snake_top_score=0,$scope.cardbreaker_top_score=0,$scope.board_data=[],$scope.authentication=Authentication,$scope.showing_add_list=!1,$scope.new_list_name="",$scope.board_loaded=!1,$scope.is_party_time=!1,$scope.is_filter_Time=!1,$scope.filterText="",$scope.filterTextActive="",$scope.filterAny=!0,$scope.clicking=!1,$scope.show_nibbles=!1,$scope.filtering_labels=!1,$scope.nibbles_cloak=!1,$scope.show_cardbreaker=!1,$scope.cardbreaker_cloak=!1,$scope.achievements=[],$scope.dirq=[],$scope.filter_labels_active=$scope.filter_labels=[!1,!1,!1,!1,!1,!1],$scope.wello_snake=[],$scope.new_card_name="";var the_party,filter_anim_to,edit_list,filter_regex,clicktime,clickx,clicky,list_index_from,card_anim_prev,card_anim_now,card_anim_elapsed,cardbreaker_animation,card_return_board,munchkin_size,card_collision,x_begin,x_end,y_begin,y_end,ball_speed_x,ball_speed_y,ball_x_last,ball_y_last,ball_speed,ball_flatness,cardbreaker_score,food_type,food_image,last_laser,cb_laser,cb_count,cumulative_speed,list_from_index=null,list_to_index=null,list_uid=null,delete_list=null,add_card_list=null,party_ended=!1,open_card=null,open_list=null,list_index=-1,card_index=-1,kill_move=!1,removing_filters=!1;$scope.sortableOptions={start:function(e){$(e.target).data("ui-sortable").floating=!0},update:function(e,ui){list_from_index=ui.item.index(),list_uid=$scope.board_data.lists[list_from_index].uid},stop:function(e,ui){list_to_index=ui.item.index(),null!==list_to_index&&null!==list_from_index&&list_to_index!==list_from_index&&$http.post("/list_move",{board_id:$scope.board_data._id,move:{from_list:list_from_index,to_list:list_to_index,list_id:list_uid}}).success(function(){MessageService.remove_disaster("Current Board: "+BoardService.name,1),$timeout(function(){MessageService.flash_success("Successfully Moved List",2e3),$scope.achievement(46,1)},0)}).error(function(err){var list=$scope.board_data.lists.splice(list_to_index,1)[0];$scope.board_data.lists.splice(list_from_index,0,list),MessageService.remove_disaster("Current Board: "+BoardService.name,1),MessageService.handle_error(err)}).finally(function(){list_to_index=list_from_index=null})},axis:"x",handle:".list_head, .list_foot"},$scope.jqueryScrollbarOptions={type:"simple",disableBodyScroll:!1},$scope.hide_all=function(){$scope.something_to_cancel&&($scope.hide_add_card(),$scope.hide_delete_list(),$scope.hide_add_list(),$scope.hide_edit_list(),$scope.cancel_edit_label())},$scope.$watch(function(){return BoardService.update},function(newVal){if(void 0!==typeof newVal){$scope.is_party_time&&$scope.party_over(),$scope.board_loaded=!1;var card;if($scope.showing_add_list=!1,$scope.new_list_name="",$scope.filtering_labels=!1,removing_filters=!1,$scope.filter_labels=$scope.filter_labels_active=[!1,!1,!1,!1,!1,!1],$scope.filterText=$scope.filterTextActive="",filter_regex=new RegExp($scope.filterTextActive,"i"),$scope.filterAny=!0,$scope.is_filter_time=!1,party_ended=!1,$(".list").each(function(){$(this).removeClass("list")}),$scope.board_data=BoardService.data,add_card_list=null,$scope.new_card_name="",null!==$scope.board_data&&("undefined"!=typeof $scope.board_data.lists||8===BoardService.custom_board)){if($scope.custom_board=BoardService.custom_board,8!==$scope.custom_board)for(var i=0;i<$scope.board_data.lists.length;i++)for(var j=0;j<$scope.board_data.lists[i].cards.length;j++)card=$scope.board_data.lists[i].cards[j],card.filtered=!0,4===$scope.custom_board&&(card.servings=ingredients($scope.recipes[$scope.board_data.lists[i].cards[j].recipe_ref].food));$timeout(function(){$scope.board_loaded=!0,$scope.nibbles_cloak=7===$scope.custom_board?!0:!1,8===$scope.custom_board?($scope.cardbreaker_cloak=!0,$timeout(function(){$(".fridge1-top-content-bot").perfectScrollbar("destroy")})):($scope.cardbreaker_cloak=!1,$timeout(function(){$scope.new_list_pos=200*$scope.board_data.lists.length,$scope.board_data.update=!1,$timeout(function(){$(".list").each(function(){var thish=360-$(this).children(".list_head").height()-$(this).children(".list_foot").height()+"px";$(this).children(".scrollbar-dynamic").css({"max-height":thish}),$(this).children(".scrollbar-dynamic").perfectScrollbar({suppressScrollX:!0})}),$(".fridge1-top-content-bot").perfectScrollbar("destroy").perfectScrollbar({suppressScrollY:!0}).scrollLeft(0).perfectScrollbar("update")},0)},0))},0)}}}),$scope.show_add_list=function(){$scope.board_data.lists_locked||($scope.hide_all(),$scope.something_to_cancel=!0,$scope.showing_add_list=!0,$scope.new_list_name="",$(".fridge1-top-content-bot").scrollLeft(1e4).perfectScrollbar("update"))},$scope.commit_list_add=function(){$http.post("/list_add",{board_id:$scope.board_data._id,name:$scope.new_list_name}).success(function(data){$timeout(function(){MessageService.flash_success("Successfully Added List.",4e3),$scope.achievement(48,1)},0),$scope.board_data.lists.push(data.list),$scope.hide_add_list(),$timeout(function(){$scope.new_list_pos=200*$scope.board_data.lists.length;var $list=$(".list:eq("+($scope.board_data.lists.length-1)+")"),thish=360-$list.children(".list_head").height()-$list.children(".list_foot").height()+"px";$list.children(".scrollbar-dynamic").css({"max-height":thish}),$list.children(".scrollbar-dynamic").perfectScrollbar({suppressScrollX:!0}),$timeout(function(){$(".fridge1-top-content-bot").scrollLeft(1e4).perfectScrollbar("update")},0)},0)}).error(function(err){MessageService.handle_error(err)})},$scope.hide_add_list=function(){$scope.showing_add_list=!1,$scope.something_to_cancel=!1},$scope.show_edit_list=function(list,list_obj){$scope.board_data.lists_locked||($scope.hide_all(),open_list=list_obj,$scope.something_to_cancel=!0,$scope.board_data.lists[list].showing_edit_list=!0,edit_list=list,$scope.edit_list_name=$scope.board_data.lists[list].name,$timeout(function(){resize_list(list,-1)},0))},$scope.commit_list_name=function(){$http.post("/list_name",{board_id:$scope.board_data._id,list:edit_list,list_id:open_list.uid,name:$scope.edit_list_name}).success(function(data){$scope.achievement(43,1),$timeout(function(){MessageService.flash_success("Successfully Updated List Name.",3e3)},0),$scope.board_data.lists[data.list].name=data.name,$scope.hide_edit_list()}).error(function(err){MessageService.handle_error(err)})},$scope.hide_edit_list=function(){if("undefined"!=typeof edit_list&&null!==edit_list){var list=edit_list;$scope.board_data.lists[edit_list].showing_edit_list=!1,$timeout(function(){resize_list(list,-1)},0),edit_list=null,open_list=null,$scope.something_to_cancel=!1}},$scope.show_delete_list=function(list,list_obj){$scope.board_data.lists_locked||($scope.hide_all(),open_list=list_obj,$scope.something_to_cancel=!0,$scope.board_data.lists[list].showing_delete_list=!0,delete_list=list,$timeout(function(){resize_list(list,-1)},0))},$scope.commit_list_delete=function(){$http.post("/list_delete",{board_id:$scope.board_data._id,list:delete_list,list_id:open_list.uid}).success(function(data){$timeout(function(){MessageService.flash_success("Successfully Deleted List.",4e3),$scope.achievement(45,1)},0),$scope.hide_delete_list(),$scope.board_data.lists.splice(data.list,1),$timeout(function(){$scope.new_list_pos=200*$scope.board_data.lists.length,0===$scope.board_data.lists.length&&($scope.board_loaded=!1),$timeout(function(){0===$scope.board_data.lists.length&&($scope.board_loaded=!0,$timeout(function(){$("#list_adder").stop(!0)},0));var scroll_left=$(".fridge1-top-content-bot").scrollLeft();$(".fridge1-top-content-bot").scrollLeft(scroll_left-200).perfectScrollbar("update")},0)},1500)}).error(function(err){MessageService.handle_error(err)})},$scope.hide_delete_list=function(){if(null!==delete_list){var list=delete_list;$scope.board_data.lists[delete_list].showing_delete_list=!1,$timeout(function(){resize_list(list,-1)},0),delete_list=null,open_list=null,$scope.something_to_cancel=!1}},$scope.show_add_card=function(list,list_obj){$scope.board_data.cards_locked||($scope.hide_all(),open_list=list_obj,$scope.something_to_cancel=!0,$scope.board_data.lists[list].showing_add_card=!0,add_card_list=list,$scope.new_card_name="",$timeout(function(){resize_list(list,1e4)},0))},$scope.commit_card_add=function(){$scope.new_card_name.length>0&&$http.post("/add_card",{board_id:$scope.board_data._id,list:add_card_list,name:$scope.new_card_name,list_id:open_list.uid}).success(function(data){data.card.filtered=!0,$scope.board_data.lists[add_card_list].cards.push(data.card),$scope.new_card_name="",$timeout(function(){resize_list(add_card_list,1e4),$("#add_card_control").focus(),data.card.munchkined&&($timeout(function(){$scope.achievement(47,1)},3e3),$scope.achievement(12,1)),$scope.achievement(47,1),$scope.achievement(26,1),75===data.num_cards&&$timeout(function(){$scope.achievement(54,1)},4e3)},0)}).error(function(err){MessageService.handle_error(err)})},$scope.hide_add_card=function(){if(null!==add_card_list){var list=add_card_list;$scope.board_data.lists[add_card_list].showing_add_card=!1,$timeout(function(){resize_list(list,-1)},0),add_card_list=null,open_list=null,$scope.something_to_cancel=!1}},$scope.mousedown=function($event,card,listi,cardi){clicktime=(new Date).getTime(),clickx=$event.clientX,clicky=$event.clientY,open_card=card,list_index=listi,card_index=cardi},$scope.open=function($event){if((new Date).getTime()-clicktime<300&&Math.abs(clickx-$event.clientX)+Math.abs(clicky-$event.clientY)<5){kill_move=!0;var modalInstance=$modal.open({templateUrl:"myModalContent.html",controller:"ModalController",size:"",resolve:{data:function(){return{card:open_card,label_names:$scope.board_data.label_names,card_locked:$scope.board_data.cards_locked,labels_locked:$scope.board_data.card_labels_locked,toggle_card_label:$scope.toggle_card_label,commit_card_name:$scope.commit_card_name,commit_card_des:$scope.commit_card_des,commit_card_delete:$scope.commit_card_delete,food_func:$scope.food_submit,recipe_func:$scope.prepare_food,achievement_func:$scope.achievement,food:$scope.food,recipes:$scope.recipes,achievements:$scope.achievements,custom_board:$scope.custom_board}}}});$scope.hide_all(),MessageService.post("DANGER: Emitting Wello Card with Military-Grade Science"),modalInstance.result.then(function(msg){alert(msg)},function(){MessageService.remove_disaster("Current Board: "+BoardService.name,1)})}},$scope.toggle_card_label=function(label_index,cb){$http.post("/update_card_label",{board_id:$scope.board_data._id,list:list_index,card:card_index,label:label_index,card_id:open_card.uid}).success(function(data){$scope.achievement(40,1),data.toggle?MessageService.flash_success("Label Added",1e3):MessageService.flash_success("Label Removed",1e3),cb(data.toggle)}).error(function(err){"undefined"==typeof err.message?MessageService.flash_disaster("Unable to connect to server.",3e3):MessageService.flash_disaster(err.message,3e3)})},$scope.commit_card_name=function(new_name,cb){$http.post("/update_card_name",{board_id:$scope.board_data._id,list:list_index,card:card_index,name:new_name,card_id:open_card.uid}).success(function(data){$scope.achievement(41,1),MessageService.flash_success("Card Name Updated.",2e3),cb(data.name)}).error(function(err){"undefined"==typeof err.message?MessageService.flash_disaster("Unable to connect to server.",3e3):MessageService.flash_disaster(err.message,3e3)})},$scope.commit_card_des=function(new_des,cb){$http.post("/update_card_des",{board_id:$scope.board_data._id,list:list_index,card:card_index,des:new_des,card_id:open_card.uid}).success(function(data){$scope.achievement(42,1),MessageService.flash_success("Card Description Updated.",2e3),cb(data.des)}).error(function(err){"undefined"==typeof err.message?MessageService.flash_disaster("Unable to connect to server.",3e3):MessageService.flash_disaster(err.message,3e3)})},$scope.element_move_start=function($part){list_index_from=-1;for(var i=0;i<$scope.board_data.lists.length;i++)if(-1===list_index_from&&$scope.board_data.lists[i].cards.length===$part.length){list_index_from=i;for(var j=0;j<$scope.board_data.lists[i].cards.length;j++)$scope.board_data.lists[i].cards[j].$$hashKey!==$part[j].$$hashKey&&(list_index_from=-1)}},$scope.element_moved=function($indexFrom,$partTo,$indexTo){for(var list_index_to=-1,i=0;i<$scope.board_data.lists.length;i++)if(-1===list_index_to&&$scope.board_data.lists[i].cards.length===$partTo.length){list_index_to=i;for(var j=0;j<$scope.board_data.lists[i].cards.length;j++)$scope.board_data.lists[i].cards[j].$$hashKey!==$partTo[j].$$hashKey&&(list_index_to=-1)}if(list_index_from>-1&&list_index_to>-1){var temp=$scope.board_data.lists[list_index_to].cards[$indexTo];if(kill_move||party_ended){party_ended&&MessageService.flash_disaster("Dude.. That party was crazy, this card isn't getting up for awhile.",2e3);var from_offset=0,to_offset=0;list_index_from===list_index_to&&($indexTo>$indexFrom?to_offset=1:from_offset=1),$scope.board_data.lists[list_index_from].cards.splice($indexFrom+from_offset,0,temp),$scope.board_data.lists[list_index_to].cards.splice($indexTo+to_offset,1),kill_move=!1}else $http.post("/card_move",{board_id:$scope.board_data._id,move:{from_list:list_index_from,from_card:$indexFrom,to_list:list_index_to,to_card:$indexTo,card_id:temp.uid,list_to_id:$scope.board_data.lists[list_index_to].uid}}).success(function(){list_index_to===list_index_from?($scope.board_data.lists[list_index_to].cards.splice($indexTo,1),$timeout(function(){$scope.board_data.lists[list_index_to].cards.splice($indexTo,0,temp)},0)):$scope.achievement(6,1),MessageService.remove_disaster("Current Board: "+BoardService.name,1);var resize_lists=[];resize_lists.push($(".list").eq(list_index_to).children(".scrollbar-dynamic")),resize_lists.push($(".list").eq(list_index_from).children(".scrollbar-dynamic")),$timeout(function(){for(var i=0;i<resize_lists.length;i++){var scroll_pos=resize_lists[i].scrollTop();resize_lists[i].scrollTop(0).perfectScrollbar("update").scrollTop(scroll_pos)}$timeout(function(){for(var i=0;i<resize_lists.length;i++){var scroll_pos=resize_lists[i].scrollTop();resize_lists[i].scrollTop(0).perfectScrollbar("update").scrollTop(scroll_pos)}},0),MessageService.flash_success("Successfully and Amazingly Moved Wello Card without Bodily Injury",2e3)},0)}).error(function(err){var from_offset=0,to_offset=0;list_index_from===list_index_to&&($indexTo>$indexFrom?to_offset=1:from_offset=1),$scope.board_data.lists[list_index_from].cards.splice($indexFrom+from_offset,0,temp),$scope.board_data.lists[list_index_to].cards.splice($indexTo+to_offset,1),MessageService.remove_disaster("Current Board: "+BoardService.name,1),temp.munchkined&&!$scope.achievements[39].unlocked?$scope.achievement(39,1):MessageService.handle_error(err)})}else MessageService.add_disaster("Science has failed us!  Repent!",3)},$scope.card_message=function(){MessageService.post("DANGER: Emitting Wello Card with Military-Grade Science")},$scope.commit_card_delete=function(cb){$http.post("/delete_card",{board_id:$scope.board_data._id,list:list_index,card:card_index,card_id:open_card.uid}).success(function(){$timeout(function(){MessageService.flash_success("Successfully Deleted Card.",4e3),$scope.achievement(45,1)},0),$(".list:eq("+list_index+") .card:nth-child("+(card_index+1)+")").addClass("delete_card"),$scope.board_data.lists[list_index].cards.splice(card_index,1),cb()}).error(function(err){"undefined"==typeof err.message?MessageService.flash_disaster("Unable to connect to server.",3e3):MessageService.flash_disaster(err.message,3e3)})},$scope.show_edit_label=function(){$scope.hide_all(),$scope.something_to_cancel=!0,$scope.edit_label_names=[];for(var i=0;i<$scope.board_data.label_names.length;i++)$scope.edit_label_names.push($scope.board_data.label_names[i]);$scope.edit_label=!0},$scope.commit_edit_label=function(){$http.post("/update_labels",{board_id:$scope.board_data._id,labels:$scope.edit_label_names}).success(function(data){$scope.achievement(53,1),$scope.board_data.label_names=data,MessageService.flash_success("Successfully Updated Labels",2e3),$scope.cancel_edit_label()}).error(function(err){"undefined"==typeof err.message?MessageService.flash_disaster("Unable to connect to server.",3e3):MessageService.flash_disaster(err.message,3e3)})},$scope.cancel_edit_label=function(){$scope.something_to_cancel=!1,$scope.edit_label_names=[],$scope.edit_label=!1,$scope.label_hover=-1},$scope.any_label=function(labels){for(var i=0;i<labels.length;i++)if(labels[i]&&$scope.filter_labels_active[i])return!0;return!1},$scope.all_labels=function(labels){for(var i=0;i<$scope.filter_labels_active.length;i++)if($scope.filter_labels_active[i]&&!labels[i])return!1;return!0},$scope.toggle_filter_any=function(){$scope.filterAny=$scope.filterAny?!1:!0,$scope.filter_anim_start()},$scope.filter_anim_start=function(){$scope.achievement(9,1);var card;$scope.is_filter_time=!0,removing_filters=!0;for(var i=0;i<$scope.filter_labels_active.length;i++)if($scope.filter_labels[i]){removing_filters=!1;break}$timeout.cancel(filter_anim_to),$timeout(function(){$scope.filterTextActive=$scope.filterText,$scope.filter_labels_active=$scope.filter_labels,$scope.filtering_labels=!1;for(var i=0;i<$scope.filter_labels_active.length;i++)if($scope.filter_labels_active[i]){$scope.filtering_labels=!0;break}for(i=0;i<$scope.board_data.lists.length;i++)for(var j=0;j<$scope.board_data.lists[i].cards.length;j++)card=$scope.board_data.lists[i].cards[j],card.filtered=!0,""!==$scope.filterTextActive&&-1===card.name.search(new RegExp($scope.filterTextActive,"i"))&&-1===card.des.search(new RegExp($scope.filterTextActive,"i"))&&(card.filtered=!1),card.filtered&&$scope.filtering_labels&&!removing_filters&&(card.filtered=$scope.filterAny?$scope.any_label(card.labels):$scope.all_labels(card.labels))},0),filter_anim_to=$timeout(function(){$scope.is_filter_time=!1,$timeout(function(){$(".list").each(function(){$(this).children(".scrollbar-dynamic").scrollTop(0).perfectScrollbar("update").scrollTop(-1e3)})},0)},600)},$scope.toggle_filter_lab=function(lab){$scope.filter_labels[lab]=$scope.filter_labels[lab]?!1:!0,$scope.filter_anim_start()},$scope.cancel_filter=function(){$scope.filterText="",$scope.filter_labels=[!1,!1,!1,!1,!1,!1],$scope.filter_anim_start()},$scope.$watch(function(){return FoodService.update},function(newVal,oldVal){if(newVal!==oldVal&&void 0!==typeof newVal){$scope.food=FoodService.food,$scope.recipes=FoodService.recipes,$scope.achievements=FoodService.achievements,$scope.food_categories=[{name:"",id:0}];var i,j,food_cat_found,lut={};for(i=0;i<$scope.food.length;i++){if(""!==$scope.food[i].cat){for(food_cat_found=!1,j=0;j<$scope.food_categories.length;j++)$scope.food_categories[j].name===$scope.food[i].cat&&(food_cat_found=!0);food_cat_found||($scope.food_categories.push({name:$scope.food[i].cat,id:$scope.food_categories.length,food:[{name:"",id:-1}]}),lut[$scope.food[i].cat]=$scope.food_categories[$scope.food_categories.length-1].food),lut[$scope.food[i].cat].push({name:$scope.food[i].name,id:i})}else $scope.ice_id=i;$scope.food[i].recipes_used_in=[]}for(i=0;i<$scope.recipes.length;i++)for(j=0;j<$scope.recipes[i].food.length;j++)$scope.food[$scope.recipes[i].food[j].food].recipes_used_in.push(i);$scope.food_category=$scope.food_categories[0],$scope.food_select=null}}),$scope.food_category_select=function(){$scope.food_category.id>=0&&($scope.select_food=$scope.food_categories[$scope.food_category.id].food[0])},$scope.food_submit=function(ice){var food_id=-1;ice>=0?food_id=ice:$scope.select_food.id>=0&&(food_id=$scope.select_food.id),food_id>=0&&$http.post("/add_food",{food_ref:food_id}).success(function(data){if($scope.food[data.food_id].count+=data.create,$scope.food[data.food_id].count>500?($scope.achievement(4,1),$timeout(function(){$scope.achievement(24,1)},3e3)):$scope.achievement(24,1),4===$scope.custom_board)for(var i=0;i<$scope.board_data.lists.length;i++)for(var j=0;j<$scope.board_data.lists[i].cards.length;j++)-1!==$scope.food[data.food_id].recipes_used_in.indexOf($scope.board_data.lists[i].cards[j].recipe_ref)&&($scope.board_data.lists[i].cards[j].servings=ingredients($scope.recipes[$scope.board_data.lists[i].cards[j].recipe_ref].food))}).error(function(err){MessageService.handle_error(err)})},$scope.prepare_food=function(recipe_id){$http.post("/prepare_recipe",{recipe_ref:recipe_id}).success(function(data){var i,j;$scope.achievement(25,1),FoodPrepService.new_food=$scope.recipes[data.prepared].image,FoodPrepService.food_id=data.prepared;var foods_used=data.food_uses,recipes_updated=[];for(i=0;i<foods_used.length;i++)for($scope.food[foods_used[i].food].count-=foods_used[i].amount,j=0;j<$scope.food[foods_used[i].food].recipes_used_in.length;j++)-1===recipes_updated.indexOf($scope.food[foods_used[i].food].recipes_used_in[j])&&recipes_updated.push($scope.food[foods_used[i].food].recipes_used_in[j]);for(i=0;i<$scope.board_data.lists.length;i++)for(j=0;j<$scope.board_data.lists[i].cards.length;j++)-1!==recipes_updated.indexOf($scope.board_data.lists[i].cards[j].recipe_ref)&&($scope.board_data.lists[i].cards[j].servings=ingredients($scope.recipes[$scope.board_data.lists[i].cards[j].recipe_ref].food))}).error(function(err){MessageService.handle_error(err)})},$scope.munchkin_snack=function(){var rand=Math.floor(Math.random()*$scope.recipes.length);FoodPrepService.new_food=$scope.recipes[rand].image,FoodPrepService.food_id=rand,$timeout(function(){rand=Math.floor(Math.random()*$scope.recipes.length),FoodPrepService.new_food=$scope.recipes[rand].image,FoodPrepService.food_id=rand},1e3+1e3*Math.random()),$timeout(function(){rand=Math.floor(Math.random()*$scope.recipes.length),FoodPrepService.new_food=$scope.recipes[rand].image,FoodPrepService.food_id=rand},2e3+1e3*Math.random()),$scope.achievement(2,1)},$scope.$watch(function(){return AchievementService.amount},function(newVal){0!==newVal&&($scope.achievement(AchievementService.id,AchievementService.amount),AchievementService.amount=0)}),$scope.achievement=function(achievement_id,achievement_amount){$scope.achievements[achievement_id].unlocked||$http.post("/achievement",{achievement:achievement_id,update:achievement_amount}).success(function(data){if(data.achievement_unlocked>=0&&($scope.achievements[data.achievement_unlocked].unlocked=!0,MessageService.flash_achievement("Achievement Unlocked: "+$scope.achievements[achievement_id].name,4e3),6===$scope.custom_board)){for(var lock_list=$scope.board_data.lists[$scope.achievements[achievement_id].locked_list],move_card=null,i=0;i<lock_list.cards.length;i++)lock_list.cards[i].achievement_ref===achievement_id&&(move_card=lock_list.cards.splice(i,1)[0]);null!==move_card&&$scope.board_data.lists[4].cards.push(move_card)}}).error(function(){})},$scope.wello_snake_start=function(){if(!$scope.show_nibbles){$scope.nibbles_cloak=!0,$scope.achievement(13,1),$scope.achievement(15,1),MessageService.post("Wello Snake - Score: 0 (Top Score: "+$scope.snake_top_score+")");var return_board=$scope.board_data._id;BoardService.board_request="snake",BoardService.force=!0,$scope.show_nibbles=!0,BoardService.show_nibbles=!0,$scope.obstacles=[];
var cur_x=40,cur_y=2;$scope.wello_snake=[{x:cur_x,y:cur_y}],$scope.x_dir=1,$scope.y_dir=0,$scope.snake_score=0;var cur_dir,new_dir,new_snake_cat,new_snake_cat_color,snake_speed=70,max_snake=15,wello_colors=["rgb(52, 178, 125)","rgb(219, 219, 87)","rgb(224, 153, 82)","rgb(203, 77, 77)","rgb(153, 51, 204)","rgb(77, 119, 203)"];$scope.cat_x=4+Math.floor(17*Math.random()),$scope.cat_y=4+Math.floor(8*Math.random()),$scope.snake_cat="/modules/core/img/cats/"+Math.floor(12*Math.random())+".jpg";var cur_snake_cat_color=Math.floor(6*Math.random());for($scope.snake_cat_color=wello_colors[cur_snake_cat_color],$scope.cat_size=24,$scope.list_x=45+Math.floor(21*Math.random()),$scope.list_y=4,$scope.list_size_x=19,$scope.list_size_y=33,$scope.candy_x=Math.floor(90*Math.random()),$scope.candy_y=Math.floor(40*Math.random());notOKCandySpawn();)$scope.candy_x=Math.floor(90*Math.random()),$scope.candy_y=Math.floor(40*Math.random());$timeout(function(){$scope.nibbles_cloak=!1},500);var tick=function(){$timeout(function(){if($scope.dirq.length>0){for(new_dir=parseInt($scope.dirq.splice(0,1));new_dir===cur_dir;)new_dir=parseInt($scope.dirq.splice(0,1));cur_dir=new_dir,1===cur_dir&&1!==$scope.y_dir?($scope.x_dir=0,$scope.y_dir=-1):2===cur_dir&&-1!==$scope.x_dir?($scope.x_dir=1,$scope.y_dir=0):3===cur_dir&&-1!==$scope.y_dir?($scope.x_dir=0,$scope.y_dir=1):4===cur_dir&&1!==$scope.x_dir&&($scope.x_dir=-1,$scope.y_dir=0)}if(cur_x+=$scope.x_dir,cur_y+=$scope.y_dir,$scope.wello_snake.push({x:cur_x,y:cur_y}),$scope.wello_snake.length>0){if(cur_x===$scope.candy_x&&cur_y===$scope.candy_y){for($scope.snake_score++,10===$scope.snake_score?$scope.achievement(14,1):20===$scope.snake_score&&$scope.achievement(16,1),$scope.snake_score>$scope.snake_top_score&&($scope.snake_top_score=$scope.snake_score),MessageService.post("Wello Snake - Score: "+$scope.snake_score+" (Top Score: "+$scope.snake_top_score+")"),max_snake*=1.2,snake_speed/=1.08;notOKCandySpawn();)$scope.candy_x=Math.floor(90*Math.random()),$scope.candy_y=Math.floor(40*Math.random());for(new_snake_cat=Math.floor(12*Math.random());new_snake_cat===$scope.snake_cat;)new_snake_cat=Math.floor(12*Math.random());for($scope.snake_cat="/modules/core/img/cats/"+new_snake_cat+".jpg",new_snake_cat_color=Math.floor(6*Math.random());new_snake_cat_color===cur_snake_cat_color;)new_snake_cat_color=Math.floor(6*Math.random());cur_snake_cat_color=new_snake_cat_color,$scope.snake_cat_color=wello_colors[cur_snake_cat_color]}else if(0>cur_x||cur_x>90||0>cur_y||cur_y>40||cur_x>=$scope.cat_x&&cur_x<$scope.cat_x+$scope.cat_size&&cur_y>=$scope.cat_y&&cur_y<$scope.cat_y+$scope.cat_size||cur_x>=$scope.list_x&&cur_x<$scope.list_x+$scope.list_size_x&&cur_y>=$scope.list_y&&cur_y<$scope.list_y+$scope.list_size_y)$scope.wello_snake=[],$scope.dirq=[],$timeout(function(){$scope.show_nibbles=!1,$scope.nibbles_cloak=!0,BoardService.show_nibbles=!1,BoardService.board_request=return_board},600);else for(var i=0;i<$scope.wello_snake.length-1;i++)cur_x===$scope.wello_snake[i].x&&cur_y===$scope.wello_snake[i].y&&($scope.wello_snake=[],$scope.dirq=[],$timeout(function(){$scope.show_nibbles=!1,$scope.nibbles_cloak=!0,BoardService.show_nibbles=!1,BoardService.board_request=return_board},600));$scope.wello_snake.length>max_snake?($scope.wello_snake.splice(0,1),tick()):$scope.wello_snake.length>0&&$scope.show_nibbles&&tick()}},snake_speed)};tick()}},$scope.wello_cardbreaker_start=function(){$scope.show_cardbreaker||($scope.cardbreaker_cloak=!0,MessageService.post("Wello Card Breaker - Score: 0 (Top Score: "+$scope.cardbreaker_top_score+")"),card_return_board=$scope.board_data._id,BoardService.board_request="cardbreaker",BoardService.force=!0,$scope.show_cardbreaker=!0,BoardService.show_cardbreaker=!0,$timeout(function(){last_laser=card_anim_now=Date.now(),$scope.dropping_food=[],$scope.ball_x=200,cb_laser=!1,$scope.ball_y=350,cardbreaker_score=0,ball_speed_x=-250,ball_speed_y=-250,cumulative_speed=1,$scope.paddle_size=100,$scope.cardbreaker_cloak=!1,munchkin_size=25,$scope.cb_lives=3,cb_count=15,$scope.lasers=[],$scope.cb_level=[[{labels:2},{labels:1},{labels:2}],[{labels:1},{labels:4},{labels:3}],[{labels:1},{labels:6,name:"SALAD = BAD"},{labels:2}],[{labels:1},{labels:4},{labels:3}],[{labels:2},{labels:1},{labels:2}]],init_cb_pos(),animate_cardbreaker()},500))},$scope.movepaddle=function(event){$scope.show_cardbreaker&&($scope.paddle_x=event.offsetX||event.clientX-$(event.target).offset().left,$scope.paddle_x>910-$scope.paddle_size&&($scope.paddle_x=910-$scope.paddle_size))},$scope.party_time=function(){if(!$scope.is_party_time){if(0!==$scope.custom_board)return void MessageService.flash_disaster("You can't party on a special board, show some respect.",3e3);if($scope.board_data.lists.length<2)return void(0===$scope.board_data.lists.length?(MessageService.flash_disaster("you had a party, but no lists showed up. =(",2800),$timeout(function(){$scope.achievement(51,1)},3e3)):MessageService.flash_disaster("One list would be a lonely party.",3e3));for(var count=0,i=0;i<$scope.board_data.lists.length;i++)count+=$scope.board_data.lists[i].cards.length;if(2>count)return void MessageService.flash_disaster("You have the lists, but you need some cards too.",3e3);MessageService.flash("Today's party game is: 52-Card Pickup!",6e3),$scope.achievement(17,1),$(".list").each(function(){$(this).children(".scrollbar-dynamic").perfectScrollbar("destroy")}),$scope.is_party_time=!0;for(var rlist,rlist2,rcard,rcard2,movecard,party_count=0,max_party=52,party_timeout=100,total_cards=0,i=0;i<$scope.board_data.lists.length;i++)total_cards+=$scope.board_data.lists[i].cards.length;0!==total_cards&&!function party_on(){the_party=$timeout(function(){rcard=Math.floor(Math.random()*total_cards),rlist=0;for(var i=0;i<$scope.board_data.lists.length;i++)if(rlist+=$scope.board_data.lists[i].cards.length,rlist>=rcard){rlist=i;break}for(rcard=Math.floor(Math.random()*$scope.board_data.lists[rlist].cards.length),movecard=$scope.board_data.lists[rlist].cards[rcard],rlist2=rlist;rlist===rlist2;)rlist2=Math.floor(Math.random()*$scope.board_data.lists.length);if(rcard2=Math.floor(Math.random()*$scope.board_data.lists[rlist].cards.length),$scope.board_data.lists[rlist2].cards.splice(rcard2,0,movecard),$scope.board_data.lists[rlist].cards.splice(rcard,1),party_count++,party_count>max_party)return $timeout.cancel(the_party),$timeout(function(){$scope.is_party_time=!1},1e3),void cleanup_party();for(party_on(),i=0;i<$scope.board_data.lists.length;i++)for(var j=0;j<$scope.board_data.lists[i].cards.length;j++)void 0===$scope.board_data.lists[i].cards[j]&&$scope.board_data.lists[i].cards.splice(j,1)},party_timeout)}()}},$scope.party_over=function(){$scope.is_party_time&&($timeout.cancel(the_party),$scope.is_party_time=!1,cleanup_party(),MessageService.revert())},$scope.getLabelArr=function(num){return new Array(num)}}]),angular.module("core").directive("perfectScrollbar",["$timeout",function($timeout){return{restrict:"A",link:function(scope,element){$(element).perfectScrollbar(),$timeout(function(){$(element).perfectScrollbar("update")},100)}}}]),angular.module("core").directive("welloKeys",function(){return{restrict:"A",link:function(scope){$("html").on("keydown",function(event){if(scope.show_nibbles)switch(event.keyCode){case 65:scope.dirq.push(4);break;case 87:scope.dirq.push(1);break;case 68:scope.dirq.push(2);break;case 83:scope.dirq.push(3)}switch(event.keyCode){case 27:scope.hide_all(),scope.$apply()}}),$("html").on("mousedown",function(){scope.hide_all(),scope.$apply()})}}}),angular.module("core").directive("killProp",function(){return{restrict:"A",link:function(scope,element){element.bind("mousedown",function(e){e.stopPropagation()})}}}),angular.module("core").directive("ngEnter",function(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){13===event.which&&(scope.$apply(function(){scope.$eval(attrs.ngEnter)}),event.preventDefault())})}}),angular.module("core").directive("focusnow",function(){return function(scope,element){element.focus()}}),function(window,angular){function getPreviousSibling(element){if(element=element[0],element.previousElementSibling)return angular.element(element.previousElementSibling);for(var sib=element.previousSibling;null!=sib&&1!=sib.nodeType;)sib=sib.previousSibling;return angular.element(sib)}function insertElementBefore(element,newElement){var prevSibl=getPreviousSibling(element);prevSibl.length>0?prevSibl.after(newElement):element.parent().prepend(newElement)}function elementMatchesSelector(element,selector){return element instanceof angular.element&&(element=element[0]),null!==matchingFunction?element[matchingFunction](selector):void 0}var module=angular.module("angular-sortable-view",[]);module.directive("svRoot",[function(){function shouldBeAfter(elem,pointer,isGrid){return isGrid?elem.x-pointer.x<0:elem.y-pointer.y<0}function getSortableElements(key){return ROOTS_MAP[key]}function removeSortableElements(key){delete ROOTS_MAP[key]}var sortingInProgress,ROOTS_MAP=Object.create(null);return{restrict:"A",controller:["$scope","$attrs","$interpolate","$parse",function($scope,$attrs,$interpolate,$parse){var mapKey=$interpolate($attrs.svRoot)($scope)||$scope.$id;ROOTS_MAP[mapKey]||(ROOTS_MAP[mapKey]=[]);var candidates,$placeholder,options,$helper,$original,$target,svOriginalNextSibling,isGrid=!1,onSort=$parse($attrs.svOnSort);$attrs.svOnStart=$attrs.$$element[0].attributes["sv-on-start"],$attrs.svOnStart=$attrs.svOnStart&&$attrs.svOnStart.value;var onStart=$parse($attrs.svOnStart);if(this.sortingInProgress=function(){return sortingInProgress},$attrs.svGrid){if(isGrid="true"===$attrs.svGrid?!0:"false"===$attrs.svGrid?!1:null,null===isGrid)throw"Invalid value of sv-grid attribute"}else $scope.$watchCollection(function(){return getSortableElements(mapKey)},function(collection){isGrid=!1;var array=collection.filter(function(item){return!item.container}).map(function(item){return{part:item.getPart().id,y:item.element[0].getBoundingClientRect().top}}),dict=Object.create(null);array.forEach(function(item){dict[item.part]?dict[item.part].push(item.y):dict[item.part]=[item.y]}),Object.keys(dict).forEach(function(key){dict[key].sort(),dict[key].forEach(function(item,index){index<dict[key].length-1&&item>0&&item===dict[key][index+1]&&(isGrid=!0)})})});this.$moveUpdate=function(opts,mouse,svElement,svOriginal,svPlaceholder,originatingPart,originatingIndex){var svRect=svElement[0].getBoundingClientRect();"element"===opts.tolerance&&(mouse={x:~~(svRect.left+svRect.width/2),y:~~(svRect.top+svRect.height/2)}),sortingInProgress=!0,candidates=[],$placeholder||(svPlaceholder?($placeholder=svPlaceholder.clone(),$placeholder.removeClass("ng-hide")):($placeholder=svOriginal.clone(),$placeholder.addClass("sv-visibility-hidden"),$placeholder.addClass("sv-placeholder"),$placeholder.css({height:svRect.height+"px",width:svRect.width+"px"})),svOriginalNextSibling=svOriginal[0].nextSibling,svOriginal.after($placeholder),svOriginal[0].parentNode.removeChild(svOriginal[0]),svOriginal.removeClass("sv-visibility-hidden"),$original=svOriginal,options=opts,$helper=svElement,onStart($scope,{$helper:$helper,$part:originatingPart.model(originatingPart.scope),$index:originatingIndex,$item:originatingPart.model(originatingPart.scope)[originatingIndex]})),$helper[0].reposition({x:mouse.x+document.body.scrollLeft-mouse.offset.x*svRect.width,y:mouse.y+document.body.scrollTop-mouse.offset.y*svRect.height}),getSortableElements(mapKey).forEach(function(se){if(null==opts.containment||elementMatchesSelector(se.element,opts.containment)||elementMatchesSelector(se.element,opts.containment+" *")){var rect=se.element[0].getBoundingClientRect(),center={x:~~(rect.left+rect.width/2),y:~~(rect.top+rect.height/2)};se.container||!se.element[0].scrollHeight&&!se.element[0].scrollWidth||candidates.push({element:se.element,q:(center.x-mouse.x)*(center.x-mouse.x)+(center.y-mouse.y)*(center.y-mouse.y),view:se.getPart(),targetIndex:se.getIndex(),after:shouldBeAfter(center,mouse,isGrid)}),se.container&&!se.element[0].querySelector("[sv-element]:not(.sv-placeholder):not(.sv-source)")&&candidates.push({element:se.element,q:(center.x-mouse.x)*(center.x-mouse.x)+(center.y-mouse.y)*(center.y-mouse.y),view:se.getPart(),targetIndex:0,container:!0})}});var pRect=$placeholder[0].getBoundingClientRect(),pCenter={x:~~(pRect.left+pRect.width/2),y:~~(pRect.top+pRect.height/2)};candidates.push({q:(pCenter.x-mouse.x)*(pCenter.x-mouse.x)+(pCenter.y-mouse.y)*(pCenter.y-mouse.y),element:$placeholder,placeholder:!0}),candidates.sort(function(a,b){return a.q-b.q}),candidates.forEach(function(cand,index){0!==index||cand.placeholder||cand.container?0===index&&cand.container?($target=cand,cand.element.append($placeholder)):cand.element.removeClass("sv-candidate"):($target=cand,cand.element.addClass("sv-candidate"),cand.after?cand.element.after($placeholder):insertElementBefore(cand.element,$placeholder))})},this.$drop=function(originatingPart,index,options){function afterRevert(){if(sortingInProgress=!1,$placeholder.remove(),$helper.remove(),svOriginalNextSibling.parentNode.insertBefore($original[0],svOriginalNextSibling),candidates=void 0,$placeholder=void 0,options=void 0,$helper=void 0,$original=void 0,$target){$target.element.removeClass("sv-candidate");var spliced=originatingPart.model(originatingPart.scope).splice(index,1),targetIndex=$target.targetIndex;$target.view===originatingPart&&$target.targetIndex>index&&targetIndex--,$target.after&&targetIndex++,$target.view.model($target.view.scope).splice(targetIndex,0,spliced[0]),($target.view!==originatingPart||index!==targetIndex)&&onSort($scope,{$partTo:$target.view.model($target.view.scope),$partFrom:originatingPart.model(originatingPart.scope),$item:spliced[0],$indexTo:targetIndex,$indexFrom:index}),$scope.$root.$$phase||$scope.$apply()}$target=void 0}if($placeholder)if(options.revert){var placeholderRect=$placeholder[0].getBoundingClientRect(),helperRect=$helper[0].getBoundingClientRect(),distance=Math.sqrt(Math.pow(helperRect.top-placeholderRect.top,2)+Math.pow(helperRect.left-placeholderRect.left,2)),duration=+options.revert*distance/200;duration=Math.min(duration,+options.revert),["-webkit-","-moz-","-ms-","-o-",""].forEach(function(prefix){"undefined"!=typeof $helper[0].style[prefix+"transition"]&&($helper[0].style[prefix+"transition"]="all "+duration+"ms ease")}),setTimeout(afterRevert,duration),$helper.css({top:placeholderRect.top+document.body.scrollTop+"px",left:placeholderRect.left+document.body.scrollLeft+"px"})}else afterRevert()},this.addToSortableElements=function(se){getSortableElements(mapKey).push(se)},this.removeFromSortableElements=function(se){var elems=getSortableElements(mapKey),index=elems.indexOf(se);index>-1&&(elems.splice(index,1),0===elems.length&&removeSortableElements(mapKey))}}]}}]),module.directive("svPart",["$parse",function($parse){return{restrict:"A",require:"^svRoot",controller:["$scope",function($scope){$scope.$ctrl=this,this.getPart=function(){return $scope.part},this.$drop=function(index,options){$scope.$sortableRoot.$drop($scope.part,index,options)}}],scope:!0,link:function($scope,$element,$attrs,$sortable){if(!$attrs.svPart)throw new Error("no model provided");var model=$parse($attrs.svPart);if(!model.assign)throw new Error("model not assignable");$scope.part={id:$scope.$id,element:$element,model:model,scope:$scope},$scope.$sortableRoot=$sortable;var sortablePart={element:$element,getPart:$scope.$ctrl.getPart,container:!0};$sortable.addToSortableElements(sortablePart),$scope.$on("$destroy",function(){$sortable.removeFromSortableElements(sortablePart)})}}}]),module.directive("svElement",["$parse",function($parse){return{restrict:"A",require:["^svPart","^svRoot"],controller:["$scope",function($scope){$scope.$ctrl=this}],link:function($scope,$element,$attrs,$controllers){function onMousedown(e){function onMousemove(e){moveExecuted||($element.parent().prepend(clone),moveExecuted=!0),$controllers[1].$moveUpdate(opts,{x:e.clientX,y:e.clientY,offset:pointerOffset},clone,$element,placeholder,$controllers[0].getPart(),$scope.$index)}if(!$controllers[1].sortingInProgress()&&0==e.button){moveExecuted=!1;var opts=$parse($attrs.svElement)($scope);if(opts=angular.extend({},{tolerance:"pointer",revert:200,containment:"html"},opts),opts.containment)var containmentRect=closestElement.call($element,opts.containment)[0].getBoundingClientRect();var clone,target=$element,clientRect=$element[0].getBoundingClientRect();helper||(helper=$controllers[0].helper),placeholder||(placeholder=$controllers[0].placeholder),helper?(clone=helper.clone(),clone.removeClass("ng-hide"),clone.css({left:clientRect.left+document.body.scrollLeft+"px",top:clientRect.top+document.body.scrollTop+"px"}),target.addClass("sv-visibility-hidden")):(clone=target.clone(),clone.addClass("sv-helper").css({left:clientRect.left+document.body.scrollLeft+"px",top:clientRect.top+document.body.scrollTop+"px",width:clientRect.width+"px"})),clone[0].reposition=function(coords){var targetLeft=coords.x,targetTop=coords.y,helperRect=clone[0].getBoundingClientRect(),body=document.body;containmentRect&&(targetTop<containmentRect.top+body.scrollTop&&(targetTop=containmentRect.top+body.scrollTop),targetTop+helperRect.height>containmentRect.top+body.scrollTop+containmentRect.height&&(targetTop=containmentRect.top+body.scrollTop+containmentRect.height-helperRect.height),targetLeft<containmentRect.left+body.scrollLeft&&(targetLeft=containmentRect.left+body.scrollLeft),targetLeft+helperRect.width>containmentRect.left+body.scrollLeft+containmentRect.width&&(targetLeft=containmentRect.left+body.scrollLeft+containmentRect.width-helperRect.width)),this.style.left=targetLeft-body.scrollLeft+"px",this.style.top=targetTop-body.scrollTop+"px"};var pointerOffset={x:(e.clientX-clientRect.left)/clientRect.width,y:(e.clientY-clientRect.top)/clientRect.height};html.addClass("sv-sorting-in-progress"),html.on("mousemove",onMousemove).on("mouseup",function mouseup(){html.off("mousemove",onMousemove),html.off("mouseup",mouseup),html.removeClass("sv-sorting-in-progress"),moveExecuted&&$controllers[0].$drop($scope.$index,opts)}),moveExecuted||($element.parent().prepend(clone),moveExecuted=!0),$controllers[1].$moveUpdate(opts,{x:e.clientX,y:e.clientY,offset:pointerOffset},clone,$element,placeholder,$controllers[0].getPart(),$scope.$index)}}var sortableElement={element:$element,getPart:$controllers[0].getPart,getIndex:function(){return $scope.$index}};$controllers[1].addToSortableElements(sortableElement),$scope.$on("$destroy",function(){$controllers[1].removeFromSortableElements(sortableElement)});var handle=$element;handle.on("mousedown",onMousedown),$scope.$watch("$ctrl.handle",function(customHandle){customHandle&&(handle.off("mousedown",onMousedown),handle=customHandle,handle.on("mousedown",onMousedown))});var helper;$scope.$watch("$ctrl.helper",function(customHelper){customHelper&&(helper=customHelper)});var placeholder;$scope.$watch("$ctrl.placeholder",function(customPlaceholder){customPlaceholder&&(placeholder=customPlaceholder)});var moveExecuted,html=(angular.element(document.body),angular.element(document.documentElement))}}}]),module.directive("svHandle",function(){return{require:"?^svElement",link:function($scope,$element,$attrs,$ctrl){$ctrl&&($ctrl.handle=$element)}}}),module.directive("svHelper",function(){return{require:["?^svPart","?^svElement"],link:function($scope,$element,$attrs,$ctrl){$element.addClass("sv-helper").addClass("ng-hide"),$ctrl[1]?$ctrl[1].helper=$element:$ctrl[0]&&($ctrl[0].helper=$element)}}}),module.directive("svPlaceholder",function(){return{require:["?^svPart","?^svElement"],link:function($scope,$element,$attrs,$ctrl){$element.addClass("sv-placeholder").addClass("ng-hide"),$ctrl[1]?$ctrl[1].placeholder=$element:$ctrl[0]&&($ctrl[0].placeholder=$element)}}}),angular.element(document.head).append(["<style>.sv-helper{position: fixed !important;z-index: 99999;margin: 0 !important;}.sv-candidate{}.sv-placeholder{}.sv-sorting-in-progress{-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}.sv-visibility-hidden{visibility: hidden !important;opacity: 0 !important;}</style>"].join(""));var dde=document.documentElement,matchingFunction=dde.matches?"matches":dde.matchesSelector?"matchesSelector":dde.webkitMatches?"webkitMatches":dde.webkitMatchesSelector?"webkitMatchesSelector":dde.msMatches?"msMatches":dde.msMatchesSelector?"msMatchesSelector":dde.mozMatches?"mozMatches":dde.mozMatchesSelector?"mozMatchesSelector":null;if(null==matchingFunction)throw"This browser doesn't support the HTMLElement.matches method";var closestElement=angular.element.prototype.closest||function(selector){for(var el=this[0].parentNode;el!==document.documentElement&&!el[matchingFunction](selector);)el=el.parentNode;return el[matchingFunction](selector)?angular.element(el):angular.element()}}(window,window.angular),angular.module("core").service("CapabilityService",["$timeout",function($timeout){var width,height,capability_check={};return capability_check.check_capabilities=function(scope,w,h){$timeout(function(){scope.width=w,scope.height=h,"undefined"!=typeof window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")?scope.show_mobile=!0:(scope.show_mobile=!1,scope.show_resolution_warning=1250>w?2:1500>w||w>2100?1:0,scope.show_browser_warning="object"==typeof window.chrome?0:"undefined"!=typeof InstallTrigger?1:void 0!==document.body.style.msScrollLimit?1:2)})},capability_check.init_capability_check=function(scope){height=$(window).height(),width=$(window).width(),$(window).resize(function(){height=$(window).height(),width=$(window).width(),capability_check.check_capabilities(scope,width,height)}),capability_check.check_capabilities(scope,width,height)},capability_check}]),angular.module("core").factory("BoardService",function(){return{data:[],update:0,board_request:null,name:"",show_nibbles:!1,show_cardbreaker:!1,force:!1,custom_board:0}}),angular.module("core").factory("FoodService",function(){return{food:[],recipes:[],achievements:[],update:0}}),angular.module("core").factory("FoodPrepService",function(){return{new_food:null,food_id:null}}),angular.module("core").factory("AchievementService",function(){var achieve={id:-1,amount:0};return achieve.achievement=function(achievement_id,achievement_amount){achieve.id=achievement_id,achieve.amount=achievement_amount},achieve}),angular.module("users").config(["$stateProvider",function($stateProvider){$stateProvider.state("signup",{url:"/signup",templateUrl:"modules/users/views/signup.client.view.html"}).state("signin",{url:"/signin",templateUrl:"modules/users/views/signin.client.view.html"}).state("signout",{url:"/signout",controller:function($scope,$http,$location,Authentication){$http.post("/auth/signout").success(function(){$scope.authentication=Authentication,$scope.authentication.user=null,$location.url("/singin")}).error(function(response){$scope.error=response.message})}}).state("signout_base",{url:"/signout_base",controller:function($scope,$http,$location,Authentication){$http.post("/auth/signout").success(function(){$scope.authentication=Authentication,$scope.authentication.user=null,$location.url("/fridge/base/auth")}).error(function(response){$scope.error=response.message})}})}]),angular.module("users").controller("AuthenticationController",["$scope","$http","$location","$state","Authentication","MessageService",function($scope,$http,$location,$state,Authentication,MessageService){$scope.authentication=Authentication,$scope.authentication.user&&$location.path("/home"),$scope.signup=function(fridge){$http.post("/auth/signup",$scope.credentials).success(function(response){$scope.authentication.user=response,$state.go("fridge_"+(fridge||$scope.authentication.signincb))}).error(function(response){$scope.error=response.message,MessageService.message="Error Signing Up!",MessageService.update++,MessageService.disaster=!0,MessageService.to=4e3})},$scope.signin=function(fridge){$http.post("/auth/signin",$scope.credentials).success(function(response){$scope.authentication.user=response,$state.go("fridge_"+(fridge||$scope.authentication.signincb))}).error(function(response){$scope.error=response.message,MessageService.message="Error Signing In!",MessageService.update++,MessageService.disaster=!0,MessageService.to=4e3})}}]),angular.module("users").factory("Users",["$resource",function($resource){return $resource("users",{},{update:{method:"PUT"}})}]),angular.module("users").factory("Authentication",function(){var _this=this;return _this._data={user:window.user,signincb:null},_this._data});